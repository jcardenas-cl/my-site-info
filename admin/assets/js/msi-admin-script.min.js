const{__:__,_x:_x,_n:_n,sprintf:sprintf}=wp.i18n,add_new_item_rrss=()=>{const e=document.getElementById("rrss-list"),t=document.createElement("li"),s=document.createElement("div"),n=document.createElement("div"),o=document.createElement("input"),r=document.createElement("div"),a=document.createElement("label"),i=document.createElement("input"),l=document.createElement("input"),c=document.createElement("img"),d=document.createElement("div"),m=document.createElement("input"),u=document.createElement("div"),_=document.createElement("input"),p=document.createElement("div"),f=document.createTextNode("X");t.setAttribute("class","rrss-row"),s.setAttribute("class","handler-cnt"),s.innerHTML=e.getElementsByTagName("li").length+1,r.setAttribute("class","rrss-icon-cnt"),c.setAttribute("src",msi_data.plugins_url+"/my-site-info/admin/assets/img/image-icon.svg"),i.setAttribute("type","file"),i.setAttribute("name","rrss_icon[]"),i.setAttribute("class","input-file"),i.onchange=(e=>{change_icon_preview(e)}),l.setAttribute("type","hidden"),l.setAttribute("name","current_icon[]"),l.setAttribute("value",msi_data.plugins_url+"/my-site-info/admin/assets/img/image-icon.svg"),a.append(i),a.append(c),r.append(a),r.append(l),d.setAttribute("class","url-cnt"),m.setAttribute("type","url"),m.setAttribute("placeholder","Url"),m.setAttribute("name","rrss_url[]"),d.append(m),n.setAttribute("class","rrss-font-cnt"),o.setAttribute("name","rrss_font[]"),o.setAttribute("type","text"),o.setAttribute("class","input-font"),o.setAttribute("placeholder",'<i class="icon-rrss"></i>'),n.append(o),u.setAttribute("class","name-cnt"),_.setAttribute("type","text"),_.setAttribute("placeholder","Nombre"),_.setAttribute("name","rrss_name[]"),u.append(_),p.setAttribute("class","close-btn"),p.onclick=(e=>{close_row(e)}),p.append(f),t.append(s),t.append(r),t.append(n),t.append(u),t.append(d),t.append(p),e.append(t)},msi_is_valid_email_list=e=>{const t=/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/,s=e.split(",");for(email in s)if(!s[email].trim().match(t))return!1;return!0},msi_is_valid_phone_list=e=>{const t=e.split(",");for(phone in t){var s=t[phone];if(s=s.trim(),!/^\d+$/.test(s.substring(1))||!/^\d+$/.test(s.charAt(0))&&"+"!=s.charAt(0))return!1}return!0},msi_check_and_format=()=>{const e=document.getElementById("txt-mobile-phone").value,t=document.getElementById("txt-email").value,s=document.getElementById("txt-phone").value,n=document.getElementById("txt-whatsapp").value;var o=!0,r=!0,a=!0,i=!0;return document.getElementById("txt-mobile-phone").classList.remove("error"),document.getElementById("txt-email").classList.remove("error"),document.getElementById("txt-phone").classList.remove("error"),document.getElementById("txt-whatsapp").classList.remove("error"),""==e.trim()||msi_is_valid_phone_list(e)||(o=!1,document.getElementById("txt-mobile-phone").classList.add("error")),""==t.trim()||msi_is_valid_email_list(t)||(r=!1,document.getElementById("txt-email").classList.add("error")),""==s.trim()||msi_is_valid_phone_list(s)||(a=!1,document.getElementById("txt-phone").classList.add("error")),""==n||msi_is_valid_phone_list(n)||(i=!1,document.getElementById("txt-whatsapp").classList.add("error")),!!(o&&r&&a&&i)||(alert(__("Favor, revise los campos marcados","my_site_info")),document.body.scrollTop=0,document.documentElement.scrollTop=0,!1)},close_row=e=>{var t=e.target||e.srcElement;t.closest("li").remove(),reindex_rrss_list()},close_fonts_row=e=>{var t=e.target||e.srcElement;t.closest("li").remove()},change_icon_preview=e=>{var t=e.target||e.srcElement,s=t.parentNode.querySelector("img");const[n]=t.files;n&&(s.src=URL.createObjectURL(n))},reindex_rrss_list=()=>{let e=1;const t=document.getElementById("rrss-list").querySelectorAll("li");t.forEach(t=>{t.querySelector(".handler-cnt").innerHTML=e,e++})},close_row_buttons=document.querySelectorAll(".close-btn");close_row_buttons.forEach(e=>{e.addEventListener("click",function(e){close_row(e)})});const close_font_row_buttons=document.querySelectorAll(".close-font-btn");close_font_row_buttons.forEach(e=>{e.addEventListener("click",function(e){close_fonts_row(e)})});const rrss_icon_files=document.querySelectorAll(".input-file");rrss_icon_files.forEach(e=>{e.addEventListener("change",function(e){change_icon_preview(e)})});const add_rrss_button=document.getElementById("btn-add-social-network");add_rrss_button.addEventListener("click",function(e){add_new_item_rrss(),slist(document.getElementById("rrss-list"))}),window.addEventListener("DOMContentLoaded",()=>{slist(document.getElementById("rrss-list"))});const slist=e=>{e.classList.add("slist");let t=e.getElementsByTagName("li"),s=null;for(let e of t)"false"!=e.getAttribute("draggable")&&(e.draggable=!0),e.ondragstart=(n=>{s=e;for(let e of t)e!=s&&e.classList.add("hint")}),e.ondragenter=(t=>{e!=s&&e.classList.add("active")}),e.ondragleave=(t=>{e.contains(t.fromElement)||e.classList.remove("active")}),e.ondragend=(()=>{for(let e of t)e.classList.remove("hint"),e.classList.remove("active")}),e.ondragover=(e=>{e.preventDefault()}),e.ondrop=(n=>{if(n.preventDefault(),e!=s&&"true"==e.getAttribute("draggable")){let n=0,o=0;for(let r=0;r<t.length;r++)s==t[r]&&(n=r),e==t[r]&&(o=r);n<o?e.parentNode.insertBefore(s,e.nextSibling):e.parentNode.insertBefore(s,e)}reindex_rrss_list()})},rrss_mode_selection=document.querySelector(".rrss-mode-selection");rrss_mode_selection.addEventListener("change",function(e){const t=e.target.value;"rrss-mode-fonts"==t?(document.getElementById("fonts-urls-section").classList.remove("no-display"),document.getElementById("rrss-list").classList.replace("mode-images","mode-fonts")):(document.getElementById("fonts-urls-section").classList.add("no-display"),document.getElementById("rrss-list").classList.replace("mode-fonts","mode-images"))});const show_toggle_triggers=document.querySelectorAll(".show-toggle");show_toggle_triggers.forEach(e=>{e.addEventListener("click",function(){const t=e.parentNode;t.classList.contains("msi-hidden")?t.classList.replace("msi-hidden","msi-display"):t.classList.replace("msi-display","msi-hidden")})});const msi_copy_font_url_buttons=document.querySelectorAll(".img-copy-font-url");msi_copy_font_url_buttons.forEach(e=>{e.addEventListener("click",e=>{msi_copy_font_url(e)})});const drop_area_fonts=document.getElementById("upload-fonts-container");["dragenter","dragover","dragleave","drop"].forEach(e=>{drop_area_fonts.addEventListener(e,function(e){e.preventDefault(),e.stopPropagation()},!1)}),["dragenter","dragover"].forEach(e=>{drop_area_fonts.addEventListener(e,function(){drop_area_fonts.classList.add("highlight")},!1)}),["dragleave","drop"].forEach(e=>{drop_area_fonts.addEventListener(e,function(){drop_area_fonts.classList.remove("highlight")},!1)});const handle_drop_fonts=async e=>{msi_handle_font_files(e.dataTransfer.files)};drop_area_fonts.addEventListener("drop",handle_drop_fonts,!1);const msi_handle_font_files=async e=>{const t=document.getElementById("font_file");document.querySelector("#upload-fonts-container .upload-text").innerHTML=__("Subiendo","my_site_info");const s=await msi_process_upload_queue(e);setTimeout(()=>{msi_progress_bar(0),document.querySelector("#upload-fonts-container .upload-text").innerHTML=document.querySelector("#upload-fonts-container .upload-text").getAttribute("standard-message")},1e3),t.value=null,msi_set_uploaded_fonts(s),document.getElementsByClassName("font-urls-section")[0].classList.replace("msi-hidden","msi-display")},msi_process_upload_queue=async e=>{let t=[];const s=e.length;let n=0;for(const o of e){const e=await msi_upload_font(o);"ok"==e.status?msi_progress_bar(100*n/s):msi_print_upload_error(e.message),t=e.list,n++}return JSON.parse(t)},msi_upload_font=async e=>{let t=new FormData;t.append("file",e),t.append("action","upload_font");const s=await fetch(msi_data.ajax_url,{method:"post",body:t});return await s.json()},msi_handle_css_file=async e=>{const t=document.getElementById("fonts_css_file"),s=await msi_process_css_upload(e[0]);"ok"==s.status?(t.value=null,document.querySelector(".css-url").innerHTML=s.url,document.getElementsByClassName("css-url-section")[0].classList.replace("msi-hidden","msi-display")):alert(s.message)},msi_process_css_upload=async e=>{let t=new FormData;t.append("file",e),t.append("action","msi_upload_css");const s=await fetch(msi_data.ajax_url,{method:"post",body:t});return await s.json()},msi_set_uploaded_fonts=e=>{const t=document.getElementsByClassName("fonts-urls")[0];t.innerHTML="",e.forEach(e=>{const s=document.createElement("div"),n=document.createElement("img"),o=document.createElement("input");s.classList.add("font-row"),n.setAttribute("src",`${msi_data.plugins_url}/my-site-info/admin/assets/img/copy-icon.svg`),n.classList.add("img-copy-font-url"),n.onclick=(e=>{msi_copy_font_url(e)}),o.setAttribute("type","url"),o.setAttribute("value",e),o.classList.add("txt-font-row"),s.appendChild(n),s.appendChild(o),t.insertAdjacentElement("beforeend",s)})},msi_progress_bar=e=>{const t=Math.floor(e);document.getElementById("fonts-progress-bar").style.width=t+"%",document.getElementById("fonts-progress-bar").classList.remove("error")},msi_print_upload_error=e=>{document.getElementById("fonts-progress-bar").classList.add("error"),document.querySelector("#upload-fonts-container .upload-text").innerHTML=e},list_selected_fonts=()=>{const e=document.querySelector("#font_file").files,t=Array.from(e);let s="";t.forEach(e=>{s+=`<div>${e.name}</div>`}),document.querySelector(".upload-data").innerHTML=s},msi_copy_font_url=e=>{var t=e.target||e.srcElement;const s=t.closest(".font-row").querySelector(".txt-font-row").value;navigator.clipboard.writeText(s).then(()=>{alert(__("Url copiada","my_site_info"))})};